<!DOCTYPE html>
<html class="light" lang="en">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>Register - Hostel Complaint System</title>

<script src="https://cdn.tailwindcss.com?plugins=forms,container-queries"></script>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;700&display=swap" rel="stylesheet"/>
<link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined" rel="stylesheet"/>

<script>
tailwind.config = {
  darkMode: "class",
  theme: {
    extend: {
      colors: { "primary": "#00bdd6" },
      fontFamily: { "display": ["Inter", "sans-serif"] },
    },
  },
}
</script>

<style>
.form-select {
  background-image: url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 20 20'%3e%3cpath stroke='%23333333' stroke-linecap='round' stroke-linejoin='round' stroke-width='1.5' d='M6 8l4 4 4-4'/%3e%3c/svg%3e");
  background-position: right 0.5rem center;
  background-repeat: no-repeat;
  background-size: 1.5em 1.5em;
  padding-right: 2.5rem;
}
</style>
</head>

<body class="font-display">

<div class="relative flex min-h-screen w-full flex-col bg-background-light"
style="background-image: url('https://lh3.googleusercontent.com/aida-public/AB6AXuDsWJQlTs7PFkN4T0DxAFavQU-342158e9J4RXu5MHdftts8gOzbpQaSbN4JoQVBTT2YZoLxLLm4Uq0_I9gVdkEUOSxjzUDGCnu-2fsMVIMhQq_1BBumyGv-BzO4tL_Iu3_56JiC5Cp2_K5Nit6sNkTUBFWiPCCda08356KN89TPD3ioEskXt2qZit6oWjQyW_2I3oT8mCl74DKsEQKTEcybEC3PbBQO-kh3xZ0Qf8Dq1zTxczK60W84RrzlTsef4c--VobyJt2yIE');
background-size: cover; background-position: center;">

<div class="absolute inset-0 bg-gray-900/40 backdrop-blur-sm"></div>

<div class="layout-container relative flex h-full grow flex-col">
<div class="flex flex-1 items-center justify-center p-4 sm:p-6 md:p-8">

<div class="flex w-full max-w-md flex-col items-center gap-6">

<div class="flex w-full flex-col items-center gap-2">
  <div class="flex h-16 w-16 items-center justify-center rounded-full bg-[#FAF9F6] text-[#00BCD4] shadow-md">
    <span class="material-symbols-outlined !text-4xl">school</span>
  </div>
  <h1 class="text-3xl font-bold text-white text-center">University Portal</h1>
</div>

<div class="w-full rounded-xl border border-[#00BCD4]/50 bg-[#FAF9F6] p-6 shadow-2xl sm:p-8">
<div class="flex flex-col items-center">
  <h2 class="text-2xl font-bold text-[#333333]">Create Your Account</h2>
  <p class="pt-1 pb-6 text-center text-base text-gray-500">
    Join the Hostel Complaint Management System
  </p>
</div>

<form id="registerForm" class="flex flex-col gap-4">

<label class="flex flex-col">
<p class="pb-2 font-medium">Full Name</p>
<div class="relative">
<span class="material-symbols-outlined absolute left-3 top-3 text-gray-400">person</span>
<input id="fullName" type="text"
class="h-12 w-full rounded-lg border border-gray-300 p-3 pl-10"
placeholder="Enter your full name"/>
</div>
</label>

<label class="flex flex-col">
<p class="pb-2 font-medium">Email Address</p>
<div class="relative">
<span class="material-symbols-outlined absolute left-3 top-3 text-gray-400">mail</span>
<input id="email" type="email"
class="h-12 w-full rounded-lg border border-gray-300 p-3 pl-10"
placeholder="Enter your email"/>
</div>
</label>

<label class="flex flex-col">
<p class="pb-2 font-medium">Password</p>
<div class="relative">
<span class="material-symbols-outlined absolute left-3 top-3 text-gray-400">lock</span>
<input id="passwordField" type="password"
class="h-12 w-full rounded-lg border border-gray-300 p-3 pl-10 pr-10"
placeholder="Enter your password"/>
<button type="button" id="togglePassword" class="absolute right-3 top-3 text-gray-400">
<span id="toggleIcon" class="material-symbols-outlined">visibility_off</span>
</button>
</div>
</label>

<label class="flex flex-col">
<p class="pb-2 font-medium">Select Your Role</p>
<div class="relative">
<span class="material-symbols-outlined absolute left-3 top-3 text-gray-400">badge</span>
<select id="role" class="form-select h-12 w-full rounded-lg border border-gray-300 p-3 pl-10">
<option value="Student">Student</option>
<option value="Warden">Warden</option>
</select>
</div>
</label>

<button type="submit"
class="h-12 w-full rounded-lg bg-gradient-to-r from-[#008080] to-[#000080] text-white font-semibold">
Register
</button>

<div class="text-center pt-2 text-sm">
Already have an account?
<a href="login.html" class="text-[#00BCD4] font-medium hover:underline">Login here</a>
</div>

</form>
</div>
</div>
</div>
</div>
</div>

<script>
const registerForm = document.getElementById("registerForm");

registerForm.addEventListener("submit", async (e) => {
  e.preventDefault();

  const name = document.getElementById("fullName").value.trim();
  const email = document.getElementById("email").value.trim();
  const password = document.getElementById("passwordField").value.trim();
  const role = document.getElementById("role").value;

  if (!name || !email || !password) {
    alert("Please fill all fields!");
    return;
  }

  try {
    const response = await fetch("http://localhost:5000/api/auth/register", {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify({ name, email, password, role })
    });

    const data = await response.json();

    if (!response.ok) {
      alert(data.message || "Registration failed");
      return;
    }

    // âœ… NO localStorage
    if (data.user.role === "Student") {
      window.location.href = "student_dashboard.html";
    } else if (data.user.role === "Warden") {
      window.location.href = "warden_dashboard.html";
    } else {
      alert("Invalid role");
    }

  } catch (err) {
    alert("Server not responding");
  }
});

// password toggle
document.getElementById("togglePassword").onclick = () => {
  const pass = document.getElementById("passwordField");
  const icon = document.getElementById("toggleIcon");

  if (pass.type === "password") {
    pass.type = "text";
    icon.textContent = "visibility";
  } else {
    pass.type = "password";
    icon.textContent = "visibility_off";
  }
};
</script>

</body>
</html>
